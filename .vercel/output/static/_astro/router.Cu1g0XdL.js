const X="astro:before-preparation",W="astro:after-preparation",Y="astro:before-swap",U="astro:after-swap",j=e=>document.dispatchEvent(new Event(e));class F extends Event{from;to;direction;navigationType;sourceElement;info;newDocument;signal;constructor(t,n,o,s,c,h,u,m,y,d){super(t,n),this.from=o,this.to=s,this.direction=c,this.navigationType=h,this.sourceElement=u,this.info=m,this.newDocument=y,this.signal=d,Object.defineProperties(this,{from:{enumerable:!0},to:{enumerable:!0,writable:!0},direction:{enumerable:!0,writable:!0},navigationType:{enumerable:!0},sourceElement:{enumerable:!0},info:{enumerable:!0},newDocument:{enumerable:!0,writable:!0},signal:{enumerable:!0}})}}const re=e=>e.type===X;class V extends F{formData;loader;constructor(t,n,o,s,c,h,u,m,y,d){super(X,{cancelable:!0},t,n,o,s,c,h,u,m),this.formData=y,this.loader=d.bind(this,this),Object.defineProperties(this,{formData:{enumerable:!0},loader:{enumerable:!0,writable:!0}})}}const se=e=>e.type===Y;class K extends F{direction;viewTransition;swap;constructor(t,n,o){super(Y,void 0,t.from,t.to,t.direction,t.navigationType,t.sourceElement,t.info,t.newDocument,t.signal),this.direction=t.direction,this.viewTransition=n,this.swap=o.bind(this,this),Object.defineProperties(this,{direction:{enumerable:!0},viewTransition:{enumerable:!0},swap:{enumerable:!0,writable:!0}})}}async function z(e,t,n,o,s,c,h,u,m){const y=new V(e,t,n,o,s,c,window.document,h,u,m);return document.dispatchEvent(y)&&(await y.loader(),y.defaultPrevented||(j(W),y.navigationType!=="traverse"&&P({scrollX,scrollY}))),y}function G(e,t,n){const o=new K(e,t,n);return document.dispatchEvent(o),o.swap(),o}const J=history.pushState.bind(history),x=history.replaceState.bind(history),P=e=>{history.state&&(history.scrollRestoration="manual",x({...history.state,...e},""))},C=!!document.startViewTransition,I=()=>!!document.querySelector('[name="astro-view-transitions-enabled"]'),M=(e,t)=>e.pathname===t.pathname&&e.search===t.search;let b,g,R;const H=e=>document.dispatchEvent(new Event(e)),_=()=>H("astro:page-load"),Q=()=>{let e=document.createElement("div");e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),e.className="astro-route-announcer",document.body.append(e),setTimeout(()=>{let t=document.title||document.querySelector("h1")?.textContent||location.pathname;e.textContent=t},60)},v="data-astro-transition-persist",k="data-astro-transition",D="data-astro-transition-fallback";let L,S=0;history.state?(S=history.state.index,scrollTo({left:history.state.scrollX,top:history.state.scrollY})):I()&&(x({index:S,scrollX,scrollY},""),history.scrollRestoration="manual");async function Z(e,t){try{const n=await fetch(e,t),s=(n.headers.get("content-type")??"").split(";",1)[0].trim();return s!=="text/html"&&s!=="application/xhtml+xml"?null:{html:await n.text(),redirected:n.redirected?n.url:void 0,mediaType:s}}catch{return null}}function q(){const e=document.querySelector('[name="astro-view-transitions-fallback"]');return e?e.getAttribute("content"):"animate"}function ee(){let e=Promise.resolve();for(const t of Array.from(document.scripts)){if(t.dataset.astroExec==="")continue;const n=t.getAttribute("type");if(n&&n!=="module"&&n!=="text/javascript")continue;const o=document.createElement("script");o.innerHTML=t.innerHTML;for(const s of t.attributes){if(s.name==="src"){const c=new Promise(h=>{o.onload=o.onerror=h});e=e.then(()=>c)}o.setAttribute(s.name,s.value)}o.dataset.astroExec="",t.replaceWith(o)}return e}const $=(e,t,n,o,s)=>{const c=M(t,e),h=document.title;document.title=o;let u=!1;if(e.href!==location.href&&!s)if(n.history==="replace"){const m=history.state;x({...n.state,index:m.index,scrollX:m.scrollX,scrollY:m.scrollY},"",e.href)}else J({...n.state,index:++S,scrollX:0,scrollY:0},"",e.href);if(document.title=h,R=e,c||(scrollTo({left:0,top:0,behavior:"instant"}),u=!0),s)scrollTo(s.scrollX,s.scrollY);else{if(e.hash){history.scrollRestoration="auto";const m=history.state;location.href=e.href,history.state||(x(m,""),c&&window.dispatchEvent(new PopStateEvent("popstate")))}else u||scrollTo({left:0,top:0,behavior:"instant"});history.scrollRestoration="manual"}};function te(e){const t=[];for(const n of e.querySelectorAll("head link[rel=stylesheet]"))if(!document.querySelector(`[${v}="${n.getAttribute(v)}"], link[rel=stylesheet][href="${n.getAttribute("href")}"]`)){const o=document.createElement("link");o.setAttribute("rel","preload"),o.setAttribute("as","style"),o.setAttribute("href",n.getAttribute("href")),t.push(new Promise(s=>{["load","error"].forEach(c=>o.addEventListener(c,s)),document.head.append(o)}))}return t}async function N(e,t,n,o,s){const c=(r,l)=>{const w=r.getAttribute(v),T=w&&l.head.querySelector(`[${v}="${w}"]`);if(T)return T;if(r.matches("link[rel=stylesheet]")){const A=r.getAttribute("href");return l.head.querySelector(`link[rel=stylesheet][href="${A}"]`)}return null},h=()=>{const r=document.activeElement;if(r?.closest(`[${v}]`)){if(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement){const l=r.selectionStart,w=r.selectionEnd;return{activeElement:r,start:l,end:w}}return{activeElement:r}}else return{activeElement:null}},u=({activeElement:r,start:l,end:w})=>{r&&(r.focus(),(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement)&&(typeof l=="number"&&(r.selectionStart=l),typeof w=="number"&&(r.selectionEnd=w)))},m=r=>{const l=r.dataset.astroTransitionPersistProps;return l==null||l==="false"},y=r=>{const l=document.documentElement,w=[...l.attributes].filter(({name:a})=>(l.removeAttribute(a),a.startsWith("data-astro-")));[...r.newDocument.documentElement.attributes,...w].forEach(({name:a,value:f})=>l.setAttribute(a,f));for(const a of document.scripts)for(const f of r.newDocument.scripts)if(!f.hasAttribute("data-astro-rerun")&&(!a.src&&a.textContent===f.textContent||a.src&&a.type===f.type&&a.src===f.src)){f.dataset.astroExec="";break}for(const a of Array.from(document.head.children)){const f=c(a,r.newDocument);f?f.remove():a.remove()}document.head.append(...r.newDocument.head.children);const T=document.body,A=h();document.body.replaceWith(r.newDocument.body);for(const a of T.querySelectorAll(`[${v}]`)){const f=a.getAttribute(v),E=document.querySelector(`[${v}="${f}"]`);E&&(E.replaceWith(a),E.localName==="astro-island"&&m(a)&&(a.setAttribute("ssr",""),a.setAttribute("props",E.getAttribute("props"))))}u(A)};async function d(r){function l(a){const f=a.effect;return!f||!(f instanceof KeyframeEffect)||!f.target?!1:window.getComputedStyle(f.target,f.pseudoElement).animationIterationCount==="infinite"}const w=document.getAnimations();document.documentElement.setAttribute(D,r);const A=document.getAnimations().filter(a=>!w.includes(a)&&!l(a));return Promise.allSettled(A.map(a=>a.finished))}if(s==="animate"&&!n.transitionSkipped&&!e.signal.aborted)try{await d("old")}catch{}const i=document.title,p=G(e,n.viewTransition,y);$(p.to,p.from,t,i,o),H(U),s==="animate"&&(!n.transitionSkipped&&!p.signal.aborted?d("new").finally(()=>n.viewTransitionFinished()):n.viewTransitionFinished())}function ne(){return b?.controller.abort(),b={controller:new AbortController}}async function B(e,t,n,o,s){const c=ne();if(!I()||location.origin!==n.origin){c===b&&(b=void 0),location.href=n.href;return}const h=s?"traverse":o.history==="replace"?"replace":"push";if(h!=="traverse"&&P({scrollX,scrollY}),M(t,n)&&(e!=="back"&&n.hash||e==="back"&&t.hash)){$(n,t,o,document.title,s),c===b&&(b=void 0);return}const u=await z(t,n,e,h,o.sourceElement,o.info,c.controller.signal,o.formData,m);if(u.defaultPrevented||u.signal.aborted){c===b&&(b=void 0),u.signal.aborted||(location.href=n.href);return}async function m(i){const p=i.to.href,r={signal:i.signal};if(i.formData){r.method="POST";const T=i.sourceElement instanceof HTMLFormElement?i.sourceElement:i.sourceElement instanceof HTMLElement&&"form"in i.sourceElement?i.sourceElement.form:i.sourceElement?.closest("form");r.body=T?.attributes.getNamedItem("enctype")?.value==="application/x-www-form-urlencoded"?new URLSearchParams(i.formData):i.formData}const l=await Z(p,r);if(l===null){i.preventDefault();return}if(l.redirected&&(i.to=new URL(l.redirected)),L??=new DOMParser,i.newDocument=L.parseFromString(l.html,l.mediaType),i.newDocument.querySelectorAll("noscript").forEach(T=>T.remove()),!i.newDocument.querySelector('[name="astro-view-transitions-enabled"]')&&!i.formData){i.preventDefault();return}const w=te(i.newDocument);w.length&&!i.signal.aborted&&await Promise.all(w)}async function y(){if(g&&g.viewTransition){try{g.viewTransition.skipTransition()}catch{}try{await g.viewTransition.updateCallbackDone}catch{}}return g={transitionSkipped:!1}}const d=await y();if(u.signal.aborted){c===b&&(b=void 0);return}if(document.documentElement.setAttribute(k,u.direction),C)d.viewTransition=document.startViewTransition(async()=>await N(u,o,d,s));else{const i=(async()=>{await Promise.resolve(),await N(u,o,d,s,q())})();d.viewTransition={updateCallbackDone:i,ready:i,finished:new Promise(p=>d.viewTransitionFinished=p),skipTransition:()=>{d.transitionSkipped=!0,document.documentElement.removeAttribute(D)}}}d.viewTransition.updateCallbackDone.finally(async()=>{await ee(),_(),Q()}),d.viewTransition.finished.finally(()=>{d.viewTransition=void 0,d===g&&(g=void 0),c===b&&(b=void 0),document.documentElement.removeAttribute(k),document.documentElement.removeAttribute(D)});try{await d.viewTransition.updateCallbackDone}catch(i){const p=i;console.log("[astro]",p.name,p.message,p.stack)}}async function ie(e,t){await B("forward",R,new URL(e,location.href),t??{})}function oe(e){if(!I()&&e.state){location.reload();return}if(e.state===null)return;const t=history.state,n=t.index,o=n>S?"forward":"back";S=n,B(o,R,new URL(location.href),{},t)}const O=()=>{history.state&&(scrollX!==history.state.scrollX||scrollY!==history.state.scrollY)&&P({scrollX,scrollY})};{if(C||q()!=="none")if(R=new URL(location.href),addEventListener("popstate",oe),addEventListener("load",_),"onscrollend"in window)addEventListener("scrollend",O);else{let e,t,n,o;const s=()=>{if(o!==history.state?.index){clearInterval(e),e=void 0;return}if(t===scrollY&&n===scrollX){clearInterval(e),e=void 0,O();return}else t=scrollY,n=scrollX};addEventListener("scroll",()=>{e===void 0&&(o=history.state.index,t=scrollY,n=scrollX,e=window.setInterval(s,50))},{passive:!0})}for(const e of document.scripts)e.dataset.astroExec=""}export{Y as T,X as a,re as b,se as i,ie as n,C as s};
